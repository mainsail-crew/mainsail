name: PR

on:
  push:
    branches:
      - '**'

  pull_request_target:
    types: [synchronize, opened]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Allow to stop obsolete workflows
concurrency:
  group: ci-tests-${{ github.ref }}-1
  cancel-in-progress: true

jobs:
  debs-cache:
    runs-on: ubuntu-latest
    steps:
      - name: Debs-Cache
        uses: mainsail-crew/mainsail-actions/debs-cache@master
        with:
          github_ref: ${{ github.ref }}

  build:
    needs: [ debs-cache ]
    runs-on: ubuntu-latest
    steps:
      - name: Build
        uses: mainsail-crew/mainsail-actions/build@master
        with:
          github_ref: ${{ github.ref }}
          github_sha: ${{ github.sha }}

#  call-eslint:
#    needs: [ debs-cache ]
#    uses: mainsail-crew/mainsail/.github/workflows/_eslint.yml@develop

#  call-prettier:
#    needs: [ debs-cache ]
#    uses: mainsail-crew/mainsail/.github/workflows/_prettier.yml@develop

#  call-check-locale:
#    needs: [ debs-cache ]
#    uses: mainsail-crew/mainsail/.github/workflows/_check_locale.yml@develop

#  call-size-report:
#    needs: [ debs-cache ]
#    uses: mainsail-crew/mainsail/.github/workflows/_size_report.yml@develop

#  call-test-cypress:
#    needs: [ debs-cache, call-build ]
#    uses: mainsail-crew/mainsail/.github/workflows/_test_cypress.yml@develop